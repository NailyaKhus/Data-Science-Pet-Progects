# Дипломный проект

Проект выполнен в следующих ноутбуках:
- **EDA_ts.ipynb** - анализ данных;
- **Baseline.ipynb** - в качестве бейзлайна взяты средние продажи каждого из товаров в каждом из магазинов за последний 7 дней
- в папке Statsmodels:
            1. **auto-arima-and-holt-winters.ipynb** - auto ARIMA в отличие от классической ARIMA модель сама генерирует оптимальные значения p, d и q; Holt-Winters - также известное как тройное экспоненциальное сглаживание;
            2. **Prophet.ipynb** - библиотека от facebook, разработанная для прогнозирования большого числа различных бизнес-показателей.
- **catboostregressor.ipynb** - модель градиентного бустинга;
- **LSTM_multi-output.ipynb** - multy-output модель на нейронной сети.

### Задача проекта — составить прогноз продаж для каждого из семейств продуктов в каждом из магазинов. 

## Цель проекта сделать анализ эффективности статмоделей по сравнению с структурными моделями машинного обучения и глубокого обучения

В данных 54 магазина и 33 семейства продуктов.
Временной ряд тренировочных данных с 01.01.2013 по 15.08.2017.
Временной ряд тестовых данных для submition составляет 16 дней после последней даты тренировочных данных: с 16.08.2017 по 31.08.2017.

В соревновании представлены 6 датасетов

Train содержит временные ряды магазинов (столбец store_nbr) и комбинации семейств продуктов(столбец family). Столбец sales показывает общий объем продаж семейства продуктов в конкретном магазине на указанную дату. Столбец onpromotion показывает общее количество продуктов в семействе продуктов, которые продвигались в магазине, на заданную дату.
Test - данные на тестовый период для submition.
Store - дает некоторую информацию о магазинах, таких как город, штат, тип, кластер.
Transactions - сильно коррелирует с колонкой sales из тренировочных данных. Помогает понять схемы продаж в магазинах.
Holidays and Events - метаданные. Дают информацию о праздниках.
Daily Oil Price - цена на нефть.

**Этапы выполнения:**       

- EDA (проведен анализ распределения имеющихся признаков, выполнена визуализация);
- Feature Engineering (сгенерированы новые признаки, применены методы для кодирования категориальных признаков);
- Тест Дикки-Фуллера (выполнена проверка временных рядов (каждого из семейств в каждом из магазинов) на стационарность);
- Оценена значимость полученных признаков, проведен тест Стьюдента на содержание статистически значимых различий между признаками с таргетом;
- Moving Average (получен результат на наивной модели скользящего окна); **Результат на kaggle 1.90138**
- Baseline - в качестве базовой модели взяты продажи за аналогичный период прошлого года **Результат на kaggle 1.16**
- ARIMA (подбор параметров); **Результат на kaggle 0.5472**
- Holt-Winters (с помощью ExponentialSmoothing из библиотеки statsmodels получен наилучший результат прогноза); **Результат на kaggle 0.43267**
- Prophet (посчитана модель без параметров, с параметрами holidays, а также с дополнительными временными и численными параметрами); **Результат на kaggle 0.54588**
- CatBoostRegression; **Результат на kaggle 0.8082**
- LSTM; **Результат на kaggle 0.7736**

**Выводы**
По результатам выполненной работы пришли выяснили, что с задачей прогнозирования временных рядов статистические модели справляются гораздо лучше. Структурные модели требуют более тонкой настройки для улучшения результата.
    

**Возможные пути для улучшения работы**                     
                              
1. Более тонкая настройка нейронной сети;
2. Применить ансамбли моделей;
3. Настройка функции потерь со штрафом за недопрогноз.
